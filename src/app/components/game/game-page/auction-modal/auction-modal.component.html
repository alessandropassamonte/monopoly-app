<!-- src/app/components/auction/auction-modal/auction-modal.component.html -->
<!-- QUESTO Ãˆ UN FILE COMPLETAMENTE NUOVO -->

<ion-header>
  <ion-toolbar style="--background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); --color: white;">
    <ion-title style="font-family: 'Trebuchet MS', Arial, sans-serif; font-weight: bold; display: flex; align-items: center; gap: 0.5rem;">
      <ion-icon name="hammer" style="font-size: 1.3rem;"></ion-icon>
      Asta ProprietÃ 
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cancelAuction()" style="--color: white;">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content style="--background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);">
  
  <div style="padding: 1.5rem; max-width: 600px; margin: 0 auto;">

    <!-- Property Info -->
    <div style="background: white; border-radius: 20px; padding: 2rem; 
                margin-bottom: 2rem; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); 
                border-top: 6px solid #f59e0b;">
      <div style="text-align: center;">
        <h2 style="font-family: 'Trebuchet MS', Arial, sans-serif; 
                   color: #2d3748; margin: 0 0 1rem 0; font-size: 1.5rem; font-weight: bold;">
          {{property?.name}}
        </h2>
        <div style="display: flex; justify-content: center; gap: 2rem; margin-bottom: 1.5rem;">
          <div style="text-align: center;">
            <div style="font-size: 0.9rem; color: #4a5568; margin-bottom: 0.3rem; font-weight: 500;">PREZZO INIZIALE</div>
            <div style="font-size: 1.4rem; font-weight: bold; color: #f59e0b; font-family: 'Courier New', monospace;">
              {{gameService.formatCurrency(property?.price || 0)}}
            </div>
          </div>
          <div style="text-align: center;">
            <div style="font-size: 0.9rem; color: #4a5568; margin-bottom: 0.3rem; font-weight: 500;">OFFERTA ATTUALE</div>
            <div style="font-size: 1.4rem; font-weight: bold; color: #dc2626; font-family: 'Courier New', monospace;">
              {{gameService.formatCurrency(currentBid)}}
            </div>
          </div>
        </div>
        
        <div *ngIf="highestBidder" style="background: #fef3c7; padding: 1rem; border-radius: 12px; border: 2px solid #f59e0b;">
          <div style="font-size: 0.9rem; color: #92400e; margin-bottom: 0.3rem; font-weight: 600;">MIGLIOR OFFERENTE</div>
          <div style="font-size: 1.2rem; font-weight: bold; color: #d97706;">
            {{highestBidder.name}} - {{gameService.formatCurrency(currentBid)}}
          </div>
        </div>
      </div>
    </div>

    <!-- Bid History -->
    <div *ngIf="bids.length > 0" style="background: white; border-radius: 15px; padding: 1.5rem; 
                margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
      <h3 style="margin: 0 0 1rem 0; color: #2d3748; font-size: 1.2rem; font-weight: bold;">
        ðŸ“‹ Cronologia Offerte
      </h3>
      <div style="max-height: 200px; overflow-y: auto;">
        <div *ngFor="let bid of bids; let i = index" 
             [style]="'padding: 0.8rem; border-radius: 8px; margin-bottom: 0.5rem; ' +
                     'background: ' + (i === 0 ? '#fef3c7' : '#f7fafc') + '; ' +
                     'border-left: 4px solid ' + (i === 0 ? '#f59e0b' : '#cbd5e0') + ';'">
          <div style="display: flex; justify-content: between; align-items: center;">
            <div style="flex: 1;">
              <span style="font-weight: bold; color: #2d3748;">{{bid.player.name}}</span>
              <span *ngIf="i === 0" style="color: #f59e0b; font-size: 0.8rem; margin-left: 0.5rem;">ðŸ‘‘ MIGLIORE</span>
            </div>
            <div style="font-weight: bold; color: #f59e0b; font-family: 'Courier New', monospace;">
              {{gameService.formatCurrency(bid.amount)}}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- New Bid Section -->
    <div style="background: white; border-radius: 15px; padding: 1.5rem; 
                margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
      <h3 style="margin: 0 0 1rem 0; color: #2d3748; font-size: 1.2rem; font-weight: bold;">
        ðŸ’° Nuova Offerta
      </h3>
      
      <!-- Player Selection -->
      <div style="margin-bottom: 1rem;">
        <label style="font-size: 0.9rem; color: #4a5568; margin-bottom: 0.5rem; 
                      display: block; font-weight: 600;">Giocatore</label>
        <select [(ngModel)]="selectedBidderId" 
                style="width: 100%; padding: 0.8rem 1rem; border: 2px solid #e2e8f0; 
                       border-radius: 10px; font-size: 1rem; background: #f7fafc; 
                       color: #2d3748; cursor: pointer;">
          <option value="" disabled>Seleziona giocatore...</option>
          <option *ngFor="let player of players" [value]="player.id">
            {{player.name}} ({{gameService.formatCurrency(player.balance)}})
          </option>
        </select>
      </div>
      
      <!-- Bid Amount -->
      <div style="margin-bottom: 1.5rem;">
        <label style="font-size: 0.9rem; color: #4a5568; margin-bottom: 0.5rem; 
                      display: block; font-weight: 600;">Importo Offerta</label>
        <input type="number" 
               [(ngModel)]="newBidAmount" 
               [min]="getMinimumBid()"
               placeholder="Inserisci offerta"
               style="width: 100%; padding: 0.8rem 1rem; border: 2px solid #e2e8f0; 
                      border-radius: 10px; font-size: 1rem; background: #f7fafc; 
                      font-family: 'Courier New', monospace;">
        <div style="font-size: 0.8rem; color: #4a5568; margin-top: 0.3rem;">
          Offerta minima: {{gameService.formatCurrency(getMinimumBid())}}
        </div>
      </div>

      <!-- Action Buttons -->
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <button (click)="placeBid()" 
                [disabled]="!canPlaceBid()"
                style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
                       color: white; border: none; border-radius: 10px; padding: 1rem; 
                       font-weight: 600; font-size: 1rem; cursor: pointer; 
                       transition: all 0.2s ease;"
                [style.opacity]="canPlaceBid() ? '1' : '0.5'"
                onmouseover="if (this.style.opacity === '1') { this.style.transform='translateY(-2px)' }"
                onmouseout="this.style.transform='translateY(0px)'">
          ðŸ“¢ Fai Offerta
        </button>
        
        <button (click)="endAuction()" 
                [disabled]="bids.length === 0"
                style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); 
                       color: white; border: none; border-radius: 10px; padding: 1rem; 
                       font-weight: 600; font-size: 1rem; cursor: pointer; 
                       transition: all 0.2s ease;"
                [style.opacity]="bids.length > 0 ? '1' : '0.5'"
                onmouseover="if (this.style.opacity === '1') { this.style.transform='translateY(-2px)' }"
                onmouseout="this.style.transform='translateY(0px)'">
          ðŸ”¨ Aggiudica
        </button>
      </div>
    </div>

  </div>
</ion-content>